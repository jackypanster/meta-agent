# **Qwen-Agent MVP 产品需求文档 (PRD)**

## **1\. 背景与目标**

### **1.1. 背景**

为了快速探索和验证 AI Agent 在我们业务场景中的应用潜力，我们需要构建一个最小可行产品（MVP）。当前，Qwen-Agent 框架已趋于成熟，并支持了我们业务所需的 MCP SSE 协议，为我们提供了一个坚实的基础。

本项目旨在通过集成行业领先的开源框架和公共云服务，快速搭建一个功能完备的 Agent 系统原型，以验证核心技术链路的可行性，并为后续对接公司内部私有化模型和服务奠定基础。

### **1.2. 核心目标**

在 2 周内，构建一个基于 Qwen-Agent 的命令行 AI 助手 MVP，实现以下核心能力：

1. **自然语言理解与对话**：通过集成大语言模型（LLM），使 Agent 能够理解并回应用户的自然语言指令。  
2. **外部工具调用**：通过多模态协作协议（MCP）和 SSE（Server-Sent Events）协议，使 Agent 能够调用外部工具/API 来完成特定任务。  
3. **长期记忆**：集成记忆组件，使 Agent 能够记住对话历史中的关键信息。  
4. **现代化的开发环境**：使用 uv 管理 Python 开发环境，确保高效、一致的开发体验。

## **2\. 功能需求**

### **2.1. 功能范围 (Scope)**

| 序号 | 功能模块 | 需求描述 | 优先级 |
| :---- | :---- | :---- | :---- |
| **F01** | **Agent 核心** | \- 基于 Qwen-Agent 框架进行开发。 \- 用户可以通过命令行界面（CLI）与 Agent进行多轮对话。 | **高** |
| **F02** | **LLM 集成** | \- 集成 DeepSeek V2 API 作为核心的推理引擎。 \- 系统需支持通过环境变量配置 DEEPSEEK\_API\_KEY。 \- Agent 能够将用户问题有效传递给 LLM 并处理返回结果。 | **高** |
| **F03** | **工具调用 (MCP)** | \- 对接公共的 Context7 MCP Server (https://mcp.context7.com/sse)。 \- 使用 SSE 协议 进行实时通信。 \- Agent 需要能够根据用户意图，自动选择并调用 MCP Server 提供的工具（例如，查询天气、获取新闻等）。 | **高** |
| **F04** | **记忆管理** | \- Agent能够通过内置的简单内存工具 (`src/tools/qwen_tools/memory_tools.py`) 存储和检索对话上下文中的简单事实（例如，用户的名字、偏好等）。 | **中** |
| **F05** | **开发环境** | \- 项目使用 uv 进行依赖管理和虚拟环境创建。 \- 提供清晰的 pyproject.toml 配置文件。 \- 提供 README.md，指导开发者如何快速设置环境并运行程序。 | **高** |

### **2.2. 非功能性需求**

* **性能**: Agent 的首次响应时间应在 3 秒以内（网络延迟除外）。  
* **易用性**: 开发者可以通过不超过 3 条命令完成环境设置和启动。  
* **配置**: 关键配置（如 API Key, Server URL）必须通过环境变量注入，而非硬编码。

## **3\. 技术架构**

### **3.1. 核心组件**

* **Agent 框架**: qwen-agent  
* **LLM API**: deepseek-api  
* **工具协议**: MCP over SSE  
* **MCP Server**: Context7 (Public)  
* **记忆库**: 内置简单内存模块 (`src/tools/qwen_tools/memory_tools.py`)
* **包管理器**: uv

### **3.2. 数据流**

1. **用户输入**: 用户在 CLI 中输入自然语言指令 (e.g., "帮我查一下北京今天的天气，并记住我的城市是北京").  
2. **Agent 处理**: Qwen-Agent 接收指令。  
3. **LLM 推理**: Agent 调用 **DeepSeek LLM** 进行意图识别，判断出需要 "查询天气" 和 "记忆城市" 两个任务。  
4. **记忆存储**: Agent 调用内置内存工具 (custom_save_info)，将 "用户的城市是北京" 存入记忆库。
5. **工具调用**: Agent 通过 SSE 连接到 **Context7 MCP Server**，调用 weather 工具，并传入参数 "北京"。  
6. **结果返回**: MCP Server 返回天气数据。  
7. **响应生成**: Agent 整合天气数据，并再次调用 LLM 生成对用户友好的自然语言答复。  
8. **用户输出**: CLI 显示最终结果 (e.g., "北京今天天气晴，我已经记住您的城市是北京了。").

## **4\. MVP 成功标准**

本项目 MVP 阶段视为成功，当且仅当满足以下所有条件：

1. **端到端对话**: 能够与 Agent 成功完成一次包含意图识别和信息回复的多轮对话。  
2. **工具调用成功**: 能够通过输入指令（如 "查天气"）成功触发 Agent 调用 Context7 的工具并返回正确结果。  
3. **记忆验证成功**: 能够验证内置内存工具的工作情况。例如：
   * 第一轮: "我叫张三。"  
   * 第二轮: "你好，我叫什么名字？" \-\> Agent 能正确回答 "您好，您叫张三。"  
4. **环境一键启动**: 新开发者可以根据 README.md，使用 uv 顺利创建环境并成功运行 Agent 程序。

## **5\. 后续规划 (Out of Scope for MVP)**

* 将 LLM 从 DeepSeek API 切换为公司内部私有化部署的 Qwen3-32B 模型。  
* 将 MCP Server 从 Context7 切换为公司内部私有化部署的 MCP Server。  
* 为 Agent 构建 Web UI 界面。  
* 增加更复杂的工具集和业务流程。  
* 完善的日志、监控和告警系统。